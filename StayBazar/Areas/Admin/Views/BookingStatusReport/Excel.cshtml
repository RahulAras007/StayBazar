@model  IEnumerable<CLayer.BookingStatusReport>
@{
    Layout = null;
    StayBazar.Lib.GridPager gp = new StayBazar.Lib.GridPager();
    gp.JavascriptFuncName = "showPager";
    gp.ColumnsInPager = 8;
    gp.RowsInAPage = 2;
    long i = 1;
    string invoicedate = "";
    string SupplierInvoiceDate = "";
    string type = "";
    string mtype = "";
    decimal buycost = 0, salevalue = 0, grossmargin = 0, commissionpayable = 0, netmargin = 0, gbuycost = 0, gsalevalue = 0, ggrossmargin = 0, gcommissionpayable = 0, gnetmargin = 0, grandtotal = 0;
    long nonights, noaccs, gnonights, gnoaccs;
    nonights = noaccs = gnonights = gnoaccs = 0;
}
<?xml version="1.0"?>
<ss:Workbook xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
  <ss:Styles>
     <ss:Style ss:ID="1">
        <ss:Font ss:Bold="1" /> 
     </ss:Style>
  </ss:Styles>
    <ss:Worksheet ss:Name="BookingStatusReport">
                <ss:Table>
                    <ss:Row ss:StyleID="1">
                        @*<ss:Cell><ss:Data ss:Type="String">Sl No </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Booking Date </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Booking Ref No </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Property Name </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">City </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Invoice Number </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Invoice Date </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Customer Name </ss:Data></ss:Cell>
                          <ss:Cell><ss:Data ss:Type="String">Mail Date </ss:Data></ss:Cell>
                         <ss:Cell><ss:Data ss:Type="String">Mail Status </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Customer Payment </ss:Data></ss:Cell>
                     
                        <ss:Cell><ss:Data ss:Type="String">Supplier Name </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Supplier Invoice Number</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Supplier Invoice Date</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Supplier Payment</ss:Data></ss:Cell>*@

                      @*  <ss:Cell><ss:Data ss:Type="String">Supplier Rate(Pre-tax) </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Tax Type </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Tax </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Total Supplier Buy Cost </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Booking  Rate </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Booking Value(pre-tax) </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Service Tax </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Luxury Tax </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Total Booking Value  </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Gross Margin </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Agent Commission Payable  </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Net Margin </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">Net Margin % </ss:Data></ss:Cell>*@

                        <ss:Cell><ss:Data ss:Type="String">Sl No</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Booking Date</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Booking Id</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Customer Name</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Property Name</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">City</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Accommodation Type</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Guest name</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Check In</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Check Out</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">NO of Pax</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">No of rooms</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">No of nights</ss:Data></ss:Cell>
                          <ss:Cell><ss:Data ss:Type="String">Total room nights</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Supplier Name</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Supplier value before Tax</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Tax Amount</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Total Supplier Value </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Supplier Invoice Number</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Supplier Invoice Date</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Customer Value Before Tax</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Tax Amounts</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Total Customer Value</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Gross Margin</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">SB Invoice Number</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">SB Invoice Date</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Total Invoice Value</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Total Payment to Supplier</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Sale Region</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">Sale Person</ss:Data></ss:Cell>

                    </ss:Row>
                    @foreach (CLayer.BookingStatusReport reportList in Model)
                    {
                        invoicedate = " ";
                        SupplierInvoiceDate = "";
                        DateTime checkin = reportList.CheckIn;
                        DateTime checkout = reportList.CheckOut;
                        TimeSpan ts = checkout - checkin;
                        int differenceInDays = ts.Days;
                        int NoOfPaxAdultS = reportList.NoOfPaxAdult;

                        int NoOfPaxChild = reportList.NoOfPaxChild;
                        int NOofPax = (NoOfPaxAdultS + NoOfPaxChild);

                        //amount
                        decimal TotalAmountBeforeServiceTax = ((reportList.AvgDailyRateBefreStaxForSalePrice *( reportList.NumberofNights * reportList.NumberofRooms)));
                        decimal ServiceTaxAmount = Decimal.Round((((TotalAmountBeforeServiceTax) * reportList.StaxForSalePrice) / 100), 2);
                        decimal TotalAmountwithServicetax = (TotalAmountBeforeServiceTax + ServiceTaxAmount);

                        //other amount
                        decimal Otherservicesamount = Math.Round(reportList.BuyPriceforotherservicesForSalePrice, 2);
                        decimal OtherServiceTaxAmount = Decimal.Round((((Otherservicesamount) * reportList.StaxForotherForSalePrice) / 100), 2);
                        decimal OtherTotalAmountwithServicetax = (OtherServiceTaxAmount + Otherservicesamount);
                        decimal TotalAmountBeforeServiceTaxANDOtherservicesamount = TotalAmountBeforeServiceTax + Otherservicesamount;
                        decimal ServiceTaxAmountANDOtherServiceTaxAmount = ServiceTaxAmount + OtherServiceTaxAmount;
                        ////////
                        //amount
                        decimal TotalAmountBeforeServiceTaxSupplier = ((reportList.AvgDailyRateBefreStaxForBuyPrice *(reportList.NumberofNights * reportList.NumberofRooms)));
                        decimal ServiceTaxAmountSupplier = Decimal.Round((((TotalAmountBeforeServiceTaxSupplier) * reportList.StaxForBuyPrice) / 100), 2);
                        decimal TotalAmountwithServicetaxSupplier = (TotalAmountBeforeServiceTaxSupplier + ServiceTaxAmount);
                        //other amount
                        decimal OtherservicesamountSupplier = Math.Round(reportList.BuyPriceforotherservicesForBuyprice, 2);
                        decimal OtherServiceTaxAmountSupplier = Decimal.Round((((OtherservicesamountSupplier) * reportList.StaxForotherBuyPrice) / 100), 2);
                        decimal OtherTotalAmountwithServicetaxSupplier = (OtherServiceTaxAmount + OtherservicesamountSupplier);
                        decimal TotalAmountBeforeServiceTaxSupplierandOtherservicesamountSupplier = TotalAmountBeforeServiceTaxSupplier + OtherservicesamountSupplier;
                        decimal ServiceTaxAmountSupplierandOtherServiceTaxAmountSupplier = ServiceTaxAmountSupplier + OtherServiceTaxAmountSupplier;
                        long netmarpercent = (long)Math.Round((double)(((double)(reportList.GrossMargin - reportList.AgentCommissionPayable) / reportList.TotalSupplierBuyCost)) * 100);
                        decimal Grossmargin = (TotalAmountBeforeServiceTaxANDOtherservicesamount - TotalAmountBeforeServiceTaxSupplierandOtherservicesamountSupplier);

                        if (reportList.InvoiceDate == DateTime.MinValue || reportList.InvoiceDate == null || reportList.InvoiceDate== default(DateTime))
                        {
                            // invoicedate = " ";

                        }
                        else
                        {
                            invoicedate = @reportList.InvoiceDate.ToShortDateString();
                        }

                        if (reportList.SupplierInvoiceDate == DateTime.MinValue || reportList.SupplierInvoiceDate == null || reportList.SupplierInvoiceDate == default(DateTime))
                        {
                            // SupplierInvoiceDate = " ";

                        }
                        else
                        {
                            SupplierInvoiceDate = @reportList.SupplierInvoiceDate.ToShortDateString();
                        }
                        mtype = reportList.CustomeType;
                        if (type != mtype)
                        {
                            if (type != "")
                            {
                        <ss:Row>
                            <ss:Cell ss:MergeAcross="6"><ss:Data ss:Type="String">@type Totals</ss:Data></ss:Cell>
                            <ss:Cell><ss:Data ss:Type="String">@noaccs</ss:Data></ss:Cell>
                            <ss:Cell><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                            <ss:Cell><ss:Data ss:Type="String">@nonights</ss:Data></ss:Cell>
                            <ss:Cell ss:MergeAcross="5"><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                            <ss:Cell><ss:Data ss:Type="String">@buycost.ToString("N0")</ss:Data></ss:Cell>
                            <ss:Cell ss:MergeAcross="3"><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                            <ss:Cell><ss:Data ss:Type="String">@salevalue.ToString("N0")</ss:Data></ss:Cell>
                            <ss:Cell><ss:Data ss:Type="String">@grossmargin.ToString("N0")</ss:Data></ss:Cell>
                            <ss:Cell><ss:Data ss:Type="String">@commissionpayable.ToString("N0")</ss:Data></ss:Cell>
                            <ss:Cell ss:MergeAcross="1"><ss:Data ss:Type="String">@netmargin.ToString("N0")</ss:Data></ss:Cell>
                        </ss:Row>
                        buycost = 0;
                                salevalue = 0;
                                grossmargin = 0;
                                commissionpayable = 0;
                                netmargin = 0;
                                nonights = 0;
                                noaccs = 0;
                            }
                            type = reportList.CustomeType;
                        }
                <ss:Row>
                 <ss:Cell><ss:Data ss:Type="String">@i</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.BookingDate.ToShortDateString()</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.orderno</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.CustomerName</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.PropertyName</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.City</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.AccomodationType</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.GuestName</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.CheckIn.ToShortDateString()</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.CheckOut.ToShortDateString()</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@NOofPax</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@reportList.NumberofRooms</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@reportList.NumberofNights</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@(reportList.NumberofRooms * reportList.NumberofNights)</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.SupplierName</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@TotalAmountBeforeServiceTaxSupplierandOtherservicesamountSupplier</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@ServiceTaxAmountSupplierandOtherServiceTaxAmountSupplier</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@reportList.TotalBuyPrice</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.SupplierInvoiceNumber</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@SupplierInvoiceDate</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@TotalAmountBeforeServiceTaxANDOtherservicesamount</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@ServiceTaxAmountANDOtherServiceTaxAmount</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@reportList.TotalSalePrice</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@Grossmargin</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.InvoiceNumber</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@invoicedate</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@reportList.TotalBuyPrice</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="Number">@reportList.amount</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.SalesRegion</ss:Data></ss:Cell>
                    <ss:Cell><ss:Data ss:Type="String">@reportList.SalesPerson</ss:Data></ss:Cell>




                        @*<ss:Cell><ss:Data ss:Type="String">@i</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.BookingDate.ToShortDateString()</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.orderno</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.PropertyName</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.City</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.InvoiceNumber</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.InvoiceDate.ToShortDateString()</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.CustomerName</ss:Data></ss:Cell>
                         <ss:Cell><ss:Data ss:Type="String">@{
                            if (reportList.Maildate == DateTime.MinValue || reportList.Maildate == null)
                            {


                            }
                            else
                            {
                                @reportList.Maildate.ToShortDateString()
                            }
                        }</ss:Data></ss:Cell>


                         <ss:Cell><ss:Data ss:Type="String">
    @{
        string s="";
        if (reportList.Maildate == null || reportList.Maildate == DateTime.MinValue)
    {
        s = "Mail not Sent";
    }
    else
    {
         s = "Mail  Sent";
    }

    }
                             @s</ss:Data></ss:Cell>
                         <ss:Cell><ss:Data ss:Type="String">@reportList.CustomerBillvalue</ss:Data></ss:Cell>

                        <ss:Cell><ss:Data ss:Type="String">@reportList.SupplierName</ss:Data></ss:Cell>
                       <ss:Cell><ss:Data ss:Type="String">@reportList.SupplierInvoiceNumber</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.SupplierInvoiceNumber</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@reportList.SupplierRate</ss:Data></ss:Cell>*@
                  @*  <ss:Cell><ss:Data ss:Type="String">@reportList.CustomerName</ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.SupplierRate </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.TaxType</ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.TaxRate</ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.TotalSupplierBuyCost</ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.BookingRate</ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.BookingValue</ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.ServiceTax </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.LuxuryTax </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.TotalBookingValue </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.GrossMargin </ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@reportList.AgentCommissionPayable</ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@(reportList.GrossMargin - reportList.AgentCommissionPayable)</ss:Data></ss:Cell>
    <ss:Cell><ss:Data ss:Type="String">@(netmarpercent)</ss:Data></ss:Cell>*@
                </ss:Row>
                i = i + 1;
                buycost = buycost + reportList.TotalSupplierBuyCost;
                salevalue = salevalue + reportList.TotalBookingValue;
                grossmargin = grossmargin + reportList.GrossMargin;
                commissionpayable = commissionpayable + reportList.AgentCommissionPayable;
                netmargin = netmargin + reportList.NetMargin;
                nonights += differenceInDays;
                noaccs += reportList.NumberofAccomodation;
                gnonights += differenceInDays;
                gnoaccs += reportList.NumberofAccomodation;
                gbuycost = gbuycost + reportList.TotalSupplierBuyCost;
                gsalevalue = gsalevalue + reportList.TotalBookingValue;
                ggrossmargin = ggrossmargin + reportList.GrossMargin;
                gcommissionpayable = gcommissionpayable + reportList.AgentCommissionPayable;
                gnetmargin = gnetmargin + reportList.NetMargin;
            }
                    @*<ss:Row>
                        <ss:Cell ss:MergeAcross="6"><ss:Data ss:Type="String">@type Totals</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@noaccs</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@nonights</ss:Data></ss:Cell>
                        <ss:Cell ss:MergeAcross="5"><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@buycost.ToString("N0")</ss:Data></ss:Cell>
                        <ss:Cell ss:MergeAcross="3"><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@salevalue.ToString("N0")</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@grossmargin.ToString("N0")</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@commissionpayable.ToString("N0")</ss:Data></ss:Cell>
                        <ss:Cell ss:MergeAcross="1"><ss:Data ss:Type="String">@netmargin.ToString("N0")</ss:Data></ss:Cell>
                    </ss:Row>
                    <ss:Row>
                        <ss:Cell ss:MergeAcross="6"><ss:Data ss:Type="String">Grand Totals</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@gnoaccs</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@gnonights</ss:Data></ss:Cell>
                        <ss:Cell ss:MergeAcross="5"><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@gbuycost.ToString("N0")</ss:Data></ss:Cell>
                        <ss:Cell ss:MergeAcross="3"><ss:Data ss:Type="String"> </ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@gsalevalue.ToString("N0")</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@ggrossmargin.ToString("N0")</ss:Data></ss:Cell>
                        <ss:Cell><ss:Data ss:Type="String">@gcommissionpayable.ToString("N0")</ss:Data></ss:Cell>
                        <ss:Cell ss:MergeAcross="1"><ss:Data ss:Type="String">@gnetmargin.ToString("N0")</ss:Data></ss:Cell>
                    </ss:Row>*@
              </ss:Table>
    </ss:Worksheet>
</ss:Workbook>